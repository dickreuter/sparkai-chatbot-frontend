{% load static %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script src="{% static 'js/main.js' %}"></script>


<script>
    var swiper = new Swiper('.swiper-container', {
        slidesPerView: 1,
        spaceBetween: 30,
        loop: true,
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
        },
        autoplay: {
            delay: 20000,
            disableOnInteraction: false,
        },
    });

    // Add click event listeners for left and right navigation
    document.querySelectorAll('#left-click').forEach(function(element) {
        element.addEventListener('click', function() {
            swiper.slidePrev();
        });
    });

    document.querySelectorAll('#right-click').forEach(function(element) {
        element.addEventListener('click', function() {
            swiper.slideNext();
        });
    });
    document.addEventListener('DOMContentLoaded', function() {
        var carouselElement = document.querySelector('#testimonialCarousel');
        var carouselInner = carouselElement.querySelector('.carousel-inner > .d-flex');
        var reviews = carouselElement.querySelectorAll('.review');
        var totalReviews = reviews.length;
        var visibleReviews = 3;
        var currentIndex = 0;
    
        // Clone reviews and append them to create the illusion of infinite scrolling
        reviews.forEach(function(review) {
            var clone = review.cloneNode(true);
            carouselInner.appendChild(clone);
        });
    
        // Clone the first three reviews and prepend them
        for (var i = 0; i < visibleReviews; i++) {
            var clone = reviews[i].cloneNode(true);
            carouselInner.insertBefore(clone, carouselInner.firstChild);
        }
    
        // Set initial position
        updateCarousel(false);
    
        function moveCarousel(direction) {
            currentIndex += direction;
            updateCarousel(true);
        }
    
        function updateCarousel(animate) {
            var offset = -(currentIndex + visibleReviews) * (100 / visibleReviews);
            
            if (animate) {
                carouselInner.style.transition = 'transform 0.5s ease';
            } else {
                carouselInner.style.transition = 'none';
            }
            
            carouselInner.style.transform = `translateX(${offset}%)`;
    
            if (animate) {
                // After animation, check if we need to reset position
                setTimeout(() => {
                    if (currentIndex >= totalReviews) {
                        currentIndex = 0;
                        resetPosition();
                    } else if (currentIndex < 0) {
                        currentIndex = totalReviews - 1;
                        resetPosition();
                    }
                }, 500);
            }
        }
    
        function resetPosition() {
            carouselInner.style.transition = 'none';
            updateCarousel(false);
            // Force reflow
            carouselInner.offsetHeight;
            carouselInner.style.transition = 'transform 0.5s ease';
        }
    
        carouselElement.querySelector('.carousel-control-prev').addEventListener('click', function() {
            moveCarousel(-1);
        });
    
        carouselElement.querySelector('.carousel-control-next').addEventListener('click', function() {
            moveCarousel(1);
        });
    });
</script>